$(function(){function t(i){var o=e.posId;WPBridge.callMethod("JsInvokeNative","wpEncrypt",{key:i,params:[o]},function(e){codeValue=e.data.result,$.ajax({type:"post",url:wpCommon.Url+"/wpwl/activity/getPosActivityList",async:!0,timeout:1e4,data:{posId:codeValue[0]},success:function(e){if("AES加密解密失败"==e.errMsg)aesFail||($.ajax({type:"post",url:wpCommon.Url+"/wpwl/getKey",success:function(e){i=e.data,localStorage.setItem("key",e.data),t(i)}}),aesFail=!0);else if(0==e.success)$("#listContent").hide(),$(".loading").show(),$(".middle img").attr("src","images/error_else.png"),$(".middle p").html("出错了，请稍后再试"),$(".top div").html("异常页面"),wpCommon.viewShow();else{try{if(e.success){for(var o=$("#listContHtml").html(),a=e.data,n=a.brandName,s=0;s<a.activityList.length;s++)a.activityList[s].gmtStart=a.activityList[s].gmtStart.replace(/-/g,"."),a.activityList[s].gmtEnd=a.activityList[s].gmtEnd.replace(/-/g,".");laytpl(o).render(a.activityList,function(t){$("#listConts").append(t),imgError("images/now_error.png")}),$(".top div").html(n+"活动列表")}}catch(t){$("#listContent").hide(),$(".loading").show(),$(".middle img").attr("src","images/error_else.png"),$(".middle p").html("出错了，请稍后再试"),$(".top div").html("异常页面")}wpCommon.viewShow()}},error:function(t,e,i){"timeout"==e&&($("#listContent").hide(),$(".loading").show(),$(".top div").html("网络异常")),wpCommon.viewShow()}})})}WPBridge.callMethod("JsInvokeNative","wpShowLoadingDialog",{},function(){}),window.aesFail="";var e=getUrlRequest();$.ajax({type:"post",url:wpCommon.Url+"/wpwl/getKey",async:!0,success:function(e){key=e.data,localStorage.setItem("key",e.data),t(key)}}),t(),$("#wpReload").click(function(){t(key)}),$("body").on("click","#listConts #listCont",function(){var t=e.posId,i=e.suspectId,o=$(this).attr("actionId");WPBridge.callMethod("JsInvokeNative","wpHitDotEvent",{eventId:"h5_e069",otherId:o},function(){}),window.location.href="eventDetails.html?pageId=H5_C013&otherId="+o+"&posId="+t+"&activityId="+o+"&suspectId="+i}),$("#back").on("click",function(){WPBridge.callMethod("JsInvokeNative","wpH5Back",{},"")})});